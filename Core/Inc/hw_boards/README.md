# Hardware Board Definitions

This directory contains board-specific hardware definitions for different revisions of the AT-USB LoRa Dongle.

## How It Works

- **main.h** (generated by STM32CubeMX) contains current/latest pin definitions
- **Board files** contain COMPLETE pin definitions for each HW revision
- **hw_config.h** automatically includes the correct board file based on `HW_BOARD_REV`
- Board files use `#undef` + `#define` to override main.h pins

## Why Complete Pin Definitions?

When you create v2.0 hardware and regenerate STM32CubeMX:
1. main.h gets updated with v2.0 pins
2. v1.0 builds continue working because hw_board_v1_0.h has frozen v1.0 pins
3. Each board file is independent and CubeMX-proof

## Adding a New Board Revision

1. Create new file: `hw_board_vX_Y.h`
2. Copy ALL pin definitions from current main.h
3. Add `#undef` + `#define` for each pin
4. Modify pins that changed in new revision
5. Update `hw_config.h` to include the new board
6. Add to `CMakeLists.txt` and `CMakePresets.json`

## Example: hw_board_v2_0.h

```c
#define HW_BOARD_VERSION_STRING "v2.0"

/* ALL pins defined with #undef first */
#undef SX1262_RF_SW_Pin
#undef SX1262_RF_SW_GPIO_Port
#define SX1262_RF_SW_Pin GPIO_PIN_8     // ← Changed from PB12
#define SX1262_RF_SW_GPIO_Port GPIOA     // ← Changed from GPIOB

#undef LED_GREEN_Pin
#undef LED_GREEN_GPIO_Port
#define LED_GREEN_Pin GPIO_PIN_15        // Unchanged
#define LED_GREEN_GPIO_Port GPIOB        // Unchanged
```

## STM32CubeMX Workflow

### When creating v2.0:
1. Update .ioc file with new pins
2. Generate code → main.h updated
3. Create hw_board_v2_0.h with ALL pins from new main.h
4. v1.0 continues working with frozen pins in hw_board_v1_0.h

✅ Each board revision is independent
✅ CubeMX regeneration won't break old builds
✅ Clear history of what changed between revisions

## Current Boards

- **v1.0**: Original hardware (PB12 for RF_SW)
- **v2.0**: Updated hardware (PA8 for RF_SW)
